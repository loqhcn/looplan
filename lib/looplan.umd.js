(function(c,a){typeof exports=="object"&&typeof module<"u"?a(exports,require("vue"),require("axios")):typeof define=="function"&&define.amd?define(["exports","vue","axios"],a):(c=typeof globalThis<"u"?globalThis:c||self,a(c.Looplan={},c.Vue,c.axios))})(this,function(c,a,w){"use strict";var Jn=Object.defineProperty;var Zn=(c,a,w)=>a in c?Jn(c,a,{enumerable:!0,configurable:!0,writable:!0,value:w}):c[a]=w;var g=(c,a,w)=>Zn(c,typeof a!="symbol"?a+"":a,w);function B(e,t=!0){if(typeof e!="string")return"";let o=e.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/[^a-zA-Z0-9]+/g," ").split(" ");o=o.filter(r=>r!=="");for(let r=0;r<o.length;r++)r===0&&!t?o[r]=o[r].toLowerCase():o[r]=o[r].charAt(0).toUpperCase()+o[r].slice(1).toLowerCase();return o.join("")}const $=[];function Le(e){$.find(n=>n.name===e.name)||$.push(e)}async function ee(e){var s;let t=null;for(let i in $){let l=$[i];if(l.packages&&((s=l.packages)!=null&&s.includes(e))){t=l;break}}let n=t||$[0];if(!n)throw new Error("没有网关");let o=await w.post(n.url,{name:e});if(o.data.code!==200)throw new Error(o.data.msg);if(!o.data.data.row)throw new Error("组件包不存在");const r=o.data.data.row;return r.loadStatus=0,r}function q(e,t=100){return new Promise(n=>{const o=setInterval(()=>{e()&&(clearInterval(o),n())},t)})}class Ie{constructor(){g(this,"store",new Map);g(this,"meta",new WeakMap)}register(t,n,o){this.store.has(t)||this.store.set(t,new Map);const r=this.store.get(t);r.has(n)&&this.unload(t,n);const s=typeof o=="function"?o():o;return r.set(n,s),this.meta.set(s,{el:s,group:t,value:n}),s}unload(t,n){const o=this.store.get(t);if(!o)return;if(n===void 0){for(const[,s]of o)s.remove(),this.meta.delete(s);this.store.delete(t);return}const r=o.get(n);r&&(r.remove(),this.meta.delete(r),o.delete(n)),o.size===0&&this.store.delete(t)}get(t,n){var o;return((o=this.store.get(t))==null?void 0:o.get(n))??null}exists(t,n){var o;return((o=this.store.get(t))==null?void 0:o.has(n))??!1}list(t){var n;return Array.from(((n=this.store.get(t))==null?void 0:n.values())??[])}unloadAll(){for(const t of Array.from(this.store.keys()))this.unload(t)}}class Me{constructor(){g(this,"elementManager",new Ie);g(this,"loadingPromises",new Map)}parseName(t){const n=t.split("@");return n.length===1?{packageName:n[0]}:{packageName:n[0],componentName:n[1]}}createStyleLink(t){return()=>{const n=document.createElement("link");return n.rel="stylesheet",n.href=t,n}}async loadStyle(t,n,o=""){const{packageName:r,componentName:s}=this.parseName(t),i=s?`${r}@${s}`:r;if(this.loadingPromises.has(i))return console.debug(`样式正在加载中，等待完成: %c${i}`,"color: orange"),this.loadingPromises.get(i);if(this.isStyleLoaded(t)){console.debug(`样式已加载，跳过: %c${i}`,"color: blue");return}console.debug(`加载样式: %c${i}`,"color: red");const l=this.doLoadStyle(i,n,o,s);this.loadingPromises.set(i,l);try{await l}finally{this.loadingPromises.delete(i)}}async doLoadStyle(t,n,o,r){const s=n.map((i,l)=>new Promise((m,d)=>{const f=i.replace("__version__",o),u=this.createStyleLink(f)();u.onload=()=>{console.debug(`已加载样式: %c${f}`,"color: green"),m()},u.onerror=()=>{console.error(`加载样式失败: ${f}`),document.head.removeChild(u),r?(console.warn(`组件样式加载失败，继续执行: ${f}`),m()):(console.error(`组件包样式加载失败: ${f}`,t),d(new Error(`加载样式失败: ${f}`)))},this.elementManager.register(t,`style-${l}`,u),document.head.appendChild(u)}));console.log("loadPromises",n,s),await Promise.all(s)}unloadStyle(t){const{packageName:n,componentName:o}=this.parseName(t);if(o){const r=`${n}@${o}`;console.debug(`卸载组件样式: %c${r}`,"color: orange"),this.elementManager.unload(r)}else console.debug(`卸载组件包样式: %c${n}`,"color: orange"),this.elementManager.unload(n),this.getAllGroups().forEach(s=>{s.startsWith(`${n}@`)&&this.elementManager.unload(s)})}isStyleLoaded(t){const{packageName:n,componentName:o}=this.parseName(t),r=o?`${n}@${o}`:n;return this.elementManager.list(r).length>0}getLoadedStyles(t){const{packageName:n,componentName:o}=this.parseName(t),r=o?`${n}@${o}`:n;return this.elementManager.list(r)}getAllGroups(){return[]}unloadAllStyles(){console.debug("卸载所有样式","color: red"),this.elementManager.unloadAll()}}const b=new Me;function Ne(e){return{title:e,name:e,modelType:"none"}}const h={MuloLayer:{name:"MuloLayer",title:"MuloLayer",type:"cdn",version:"v1",cdn:"http://component.loqh.cn/mulo-layer/__version__/mulo-layer.umd.js",styleCdn:[],components:[{title:"测试组件",name:"MuloTest",modelType:"none"}],loadStatus:0}},C={};class ve{constructor(){g(this,"components",{});g(this,"pkgGatewayLoading",{})}parseComponentName(t){const[n,o]=t.split("@");return`${n}@${B(o)}`}async component(t,n=null){var d;const o=this.parseComponentName(t);if(n){this.components[o]=n;return}console.debug("component 加载组件",o);const[r,s]=o.split("@");if(!h[r]&&$.length)if(this.pkgGatewayLoading[r]==0||this.pkgGatewayLoading[r]==null){this.pkgGatewayLoading[r]=1;try{const f=await ee(r);h[r]=f}catch(f){console.error("从网关加载组件包失败",r,f)}}else await q(()=>!!h[r]);if(!C[r]){const f=await this.getPackage(r);this.registerComponents(h[r],f)}const i=h[r];i&&i.styleCdn&&i.styleCdn.length>0&&i.styleImportCase==="use"&&await b.loadStyle(r,i.styleCdn,i.version||"");const l=this.getComponentOption(o);l&&l.styleImportCase==="use"&&l.styleCdn&&await b.loadStyle(o,l.styleCdn,((d=h[r])==null?void 0:d.version)||"");let m=this.components[o];if(m||(m=C[r][s]),!m)throw new Error(`未找到${o}`);return this.isAsyncComponent(r,s)?(console.debug("加载异步组件",o),m()):m}getComponentOptionObject(t){return typeof t=="string"?Ne(t):t}registerComponents(t,n){t.components.forEach(o=>{const r=this.getComponentOptionObject(o),s=B(r.name),i=`${t.name}@${s}`;this.components[i]=n[s]})}getComponentOption(t){const n=this.parseComponentName(t),[o,r]=n.split("@"),s=h[o];if(!s)return;const i=s.components.find(l=>{const m=this.getComponentOptionObject(l);return B(m.name)===r});return i?this.getComponentOptionObject(i):void 0}isAsyncComponent(t,n){const o=h[t];if(!o)return!1;if(o.asyncComponents)return o.asyncComponents.includes(n);const r=o.components.find(s=>{const i=this.getComponentOptionObject(s);return B(i.name)===n});return r?!!this.getComponentOptionObject(r).isAsync:!1}async getPackage(t){let n=h[t];if(!n)throw new Error(`组件包不存在: ${t}`);if(C[t])return C[t];if(n.type==="cdn"){if(n.loadStatus===-1&&(n.loadStatus=0),n.loadStatus===0){n.loadStatus=1;try{n.styleCdn&&n.styleCdn.length>0&&n.styleImportCase==="register"&&await b.loadStyle(t,n.styleCdn,n.version||"");const o=await this.loadOnlineComponentPackage(n);C[t]=o,n.loadStatus=200}catch(o){throw n.loadStatus=-1,o}}n.loadStatus===1&&await q(()=>!!C[t])}return n.type==="local"&&n.styleCdn&&n.styleCdn.length>0&&n.styleImportCase==="register"&&await b.loadStyle(t,n.styleCdn,n.version||""),C[t]}addLocalPackage(t,n){h[t.name]=t,C[t.name]=n,this.registerComponents(t,n)}registerPackage(t){t=Object.assign({loadStatus:0,styleImportCase:"register"},t),h[t.name]=t}loadOnlineComponentPackage(t){return new Promise((n,o)=>{const{title:r,name:s,version:i,cdn:l}=t;if(!l){o(new Error(`组件库 ${s} 未设置 CDN 地址`));return}const m=l.replace("__version__",i||""),d=document.createElement("script");d.src=m,d.onload=()=>{window[s]?(console.debug(`已加载在线组件库: %c${s}`,"color: green"),n(window[s]),t.keepOfWindow||delete window[s]):o(new Error(`组件未在全局命名空间中找到: ${s}`)),document.body.removeChild(d)},d.onerror=()=>{document.body.removeChild(d),o(new Error(`加载 ${r||s} 组件库失败`))},document.body.appendChild(d)})}}const E=new ve,Be={class:"m-tip"},te=a.defineComponent({__name:"asyncLoading",setup(e){const t=a.getCurrentInstance();return console.log("loading instance",t),a.reactive({}),(n,o)=>(a.openBlock(),a.createElementBlock("div",Be," Loading... "))}}),Ge={"[object Number]":"number","[object String]":"string","[object Boolean]":"bool","[object Array]":"array","[object Object]":"object","[object Undefined]":"undefined","[object Function]":"function","[object RegExp]":"regexp","[object Date]":"date","[object Symbol]":"symbol"};class Ve{static typeof(t){let n=Object.prototype.toString.call(t);return Ge[n]||"unknow"}static isArray(t){return Object.prototype.toString.call(t)==="[object Array]"}static isEmpty(t){return t==null?!0:typeof t=="string"?t.trim()==="":Array.isArray(t)?t.length===0:typeof t=="object"?Object.keys(t).length===0:!1}static copyObj(t){return JSON.parse(JSON.stringify(t))}}function ze(e){return typeof e!="string"?!1:e.match(/^[a-zA-Z0-9-]+@[a-zA-Z0-9-_]+$/)}function Fe(e){console.log("%c设置组件包","color:green;",e),E.addLocalPackage(e.packageConfig,e)}function Ue(e){console.debug("%c注册组件包","color:green;",e),E.registerPackage(e)}async function De(e,t,n){return b.loadStyle(e,t||[],n)}function Re(e){b.unloadStyle(e)}function qe(e){return b.isStyleLoaded(e)}function We(e){return b.getLoadedStyles(e)}function xe(){b.unloadAllStyles()}function He(e=500){return a.defineAsyncComponent({loader:()=>new Promise(async(t,n)=>{try{setTimeout(()=>{t(function(){return""})},e)}catch(o){n(o)}})})}function Je(e){return E.getComponentOption(e)}function W(e,t={}){e=E.parseComponentName(e);const n=Object.assign({errorComponent:function(o){return`组件加载失败:${e}`},loadingComponent:te},t);return a.defineAsyncComponent({loader:()=>new Promise(async(o,r)=>{try{console.debug("-- 加载组件:",e);let s=await E.component(e);if(!s){r(new Error("组件不存在:"+e));return}o(s)}catch(s){r(s)}}),...n})}const Ze={key:1,class:"m-component-error"},Ke={class:"error-msg"},Xe={name:"lp-component",inheritAttrs:!1},L=a.defineComponent({...Xe,props:{is:{type:String,default:""}},setup(e){const t=e,n=a.ref(!1),o=a.ref("");let r=null;const s=W(t.is,{loadingComponent:te,errorComponent:function(u){return""},onError:(u,y,v,A)=>{console.error("onError",A),r=y,n.value=!0,o.value=`组件加载失败: ${u.message}`,v()}});a.watch(()=>t.is,(u,y)=>{});function i(){n.value=!1,o.value="",r==null||r()}a.onErrorCaptured((u,y,v)=>!1);const l=a.useAttrs(),m=a.useSlots(),d=a.computed(()=>Object.keys(l).reduce((u,y)=>(y.startsWith("on")||(u[y]=l[y]),u),{})),f=a.computed(()=>Object.keys(l).reduce((u,y)=>{if(y.startsWith("on")){const v=y.slice(2).replace(/^\w/,A=>A.toLowerCase());u[v]=l[y]}return u},{}));return a.computed(()=>{const u={};return"modelValue"in l&&(u.modelValue=l.modelValue),u}),a.computed(()=>{const u={};return"onUpdate:modelValue"in l&&(u["update:modelValue"]=l["onUpdate:modelValue"]),u}),(u,y)=>(a.openBlock(),a.createElementBlock(a.Fragment,null,[e.is?(a.openBlock(),a.createBlock(a.resolveDynamicComponent(a.unref(s)),a.mergeProps({key:0},d.value,a.toHandlers(f.value)),a.createSlots({_:2},[a.renderList(a.unref(m),(v,A)=>({name:A,fn:a.withCtx(Hn=>[a.renderSlot(u.$slots,A,a.normalizeProps(a.guardReactiveProps(Hn||{})))])}))]),1040)):a.createCommentVNode("",!0),n.value?(a.openBlock(),a.createElementBlock("div",Ze,[a.createElementVNode("div",Ke,a.toDisplayString(o.value),1),a.createElementVNode("button",{class:"btn btn-primary link",onClick:a.withModifiers(i,["stop"])},"重试")])):a.createCommentVNode("",!0)],64))}}),Qe=Object.freeze(Object.defineProperty({__proto__:null,LpComponent:L,default:{install:e=>{e.component(L.name,L)}}},Symbol.toStringTag,{value:"Module"}));var ne=typeof global=="object"&&global&&global.Object===Object&&global,Ye=typeof self=="object"&&self&&self.Object===Object&&self,j=ne||Ye||Function("return this")(),G=j.Symbol,oe=Object.prototype,et=oe.hasOwnProperty,tt=oe.toString,I=G?G.toStringTag:void 0;function nt(e){var t=et.call(e,I),n=e[I];try{e[I]=void 0;var o=!0}catch{}var r=tt.call(e);return o&&(t?e[I]=n:delete e[I]),r}var ot=Object.prototype,rt=ot.toString;function at(e){return rt.call(e)}var st="[object Null]",ct="[object Undefined]",re=G?G.toStringTag:void 0;function k(e){return e==null?e===void 0?ct:st:re&&re in Object(e)?nt(e):at(e)}function V(e){return e!=null&&typeof e=="object"}var ae=Array.isArray;function se(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var it="[object AsyncFunction]",lt="[object Function]",ut="[object GeneratorFunction]",dt="[object Proxy]";function ce(e){if(!se(e))return!1;var t=k(e);return t==lt||t==ut||t==it||t==dt}var x=j["__core-js_shared__"],ie=function(){var e=/[^.]+$/.exec(x&&x.keys&&x.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function pt(e){return!!ie&&ie in e}var ft=Function.prototype,mt=ft.toString;function _(e){if(e!=null){try{return mt.call(e)}catch{}try{return e+""}catch{}}return""}var gt=/[\\^$.*+?()[\]{}|]/g,yt=/^\[object .+?Constructor\]$/,ht=Function.prototype,bt=Object.prototype,wt=ht.toString,Ct=bt.hasOwnProperty,jt=RegExp("^"+wt.call(Ct).replace(gt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function $t(e){if(!se(e)||pt(e))return!1;var t=ce(e)?jt:yt;return t.test(_(e))}function _t(e,t){return e==null?void 0:e[t]}function M(e,t){var n=_t(e,t);return $t(n)?n:void 0}var H=M(j,"WeakMap"),St=9007199254740991;function le(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=St}function Ot(e){return e!=null&&le(e.length)&&!ce(e)}var kt=Object.prototype;function ue(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||kt;return e===n}var Tt="[object Arguments]";function de(e){return V(e)&&k(e)==Tt}var pe=Object.prototype,Pt=pe.hasOwnProperty,At=pe.propertyIsEnumerable,Et=de(function(){return arguments}())?de:function(e){return V(e)&&Pt.call(e,"callee")&&!At.call(e,"callee")};function Lt(){return!1}var fe=typeof c=="object"&&c&&!c.nodeType&&c,me=fe&&typeof module=="object"&&module&&!module.nodeType&&module,It=me&&me.exports===fe,ge=It?j.Buffer:void 0,Mt=ge?ge.isBuffer:void 0,Nt=Mt||Lt,vt="[object Arguments]",Bt="[object Array]",Gt="[object Boolean]",Vt="[object Date]",zt="[object Error]",Ft="[object Function]",Ut="[object Map]",Dt="[object Number]",Rt="[object Object]",qt="[object RegExp]",Wt="[object Set]",xt="[object String]",Ht="[object WeakMap]",Jt="[object ArrayBuffer]",Zt="[object DataView]",Kt="[object Float32Array]",Xt="[object Float64Array]",Qt="[object Int8Array]",Yt="[object Int16Array]",en="[object Int32Array]",tn="[object Uint8Array]",nn="[object Uint8ClampedArray]",on="[object Uint16Array]",rn="[object Uint32Array]",p={};p[Kt]=p[Xt]=p[Qt]=p[Yt]=p[en]=p[tn]=p[nn]=p[on]=p[rn]=!0,p[vt]=p[Bt]=p[Jt]=p[Gt]=p[Zt]=p[Vt]=p[zt]=p[Ft]=p[Ut]=p[Dt]=p[Rt]=p[qt]=p[Wt]=p[xt]=p[Ht]=!1;function an(e){return V(e)&&le(e.length)&&!!p[k(e)]}function sn(e){return function(t){return e(t)}}var ye=typeof c=="object"&&c&&!c.nodeType&&c,N=ye&&typeof module=="object"&&module&&!module.nodeType&&module,cn=N&&N.exports===ye,J=cn&&ne.process,he=function(){try{var e=N&&N.require&&N.require("util").types;return e||J&&J.binding&&J.binding("util")}catch{}}(),be=he&&he.isTypedArray,ln=be?sn(be):an;function un(e,t){return function(n){return e(t(n))}}var dn=un(Object.keys,Object),pn=Object.prototype,fn=pn.hasOwnProperty;function mn(e){if(!ue(e))return dn(e);var t=[];for(var n in Object(e))fn.call(e,n)&&n!="constructor"&&t.push(n);return t}var Z=M(j,"Map"),K=M(j,"DataView"),X=M(j,"Promise"),Q=M(j,"Set"),we="[object Map]",gn="[object Object]",Ce="[object Promise]",je="[object Set]",$e="[object WeakMap]",_e="[object DataView]",yn=_(K),hn=_(Z),bn=_(X),wn=_(Q),Cn=_(H),S=k;(K&&S(new K(new ArrayBuffer(1)))!=_e||Z&&S(new Z)!=we||X&&S(X.resolve())!=Ce||Q&&S(new Q)!=je||H&&S(new H)!=$e)&&(S=function(e){var t=k(e),n=t==gn?e.constructor:void 0,o=n?_(n):"";if(o)switch(o){case yn:return _e;case hn:return we;case bn:return Ce;case wn:return je;case Cn:return $e}return t});var jn="[object String]";function $n(e){return typeof e=="string"||!ae(e)&&V(e)&&k(e)==jn}var _n="[object Map]",Sn="[object Set]",On=Object.prototype,kn=On.hasOwnProperty;function Tn(e){if(e==null)return!0;if(Ot(e)&&(ae(e)||typeof e=="string"||typeof e.splice=="function"||Nt(e)||ln(e)||Et(e)))return!e.length;var t=S(e);if(t==_n||t==Sn)return!e.size;if(ue(e))return!mn(e).length;for(var n in e)if(kn.call(e,n))return!1;return!0}const O=[];function Pn(e){O.find(n=>n.name===e.name)||O.push(e)}async function Se(e){var s;console.log("## 获取图标包",e);let t=null;for(let i in O){let l=O[i];if(l.packages&&((s=l.packages)!=null&&s.includes(e))){t=l;break}}let n=t||O[0];if(!n)throw console.log("没有网关",e,O),new Error("没有网关");let o=await w.post(n.url,{name:e});if(o.data.code!==200)throw new Error(o.data.msg);if(!o.data.data.row)throw new Error("图标包不存在");return o.data.data.row}const T={},z={};async function Oe(e){let t=En(e),n=T[t.package];if(n||(z[t.package]&&await q(()=>!!T[t.package]),n=T[t.package]),!n)try{z[t.package]=1,n=await Se(t.package),T[t.package]=n,delete z[t.package]}catch(o){throw delete z[t.package],console.error("加载图标包失败",o),o}if(ke(n),!n.icons[t.icon])throw console.error("图标不存在:",t),new Error("图标不存在");return n.icons[t.icon]}function An(e){T[e.name]=e}function En(e){if(!e.includes("@"))return{package:"default",icon:e};let[t,n]=e.split("@");return{package:t,icon:n}}const F={};function ke(e){if(F[e.name])return;const t=document.createElement("style"),n=e.name||"iconfont",o=(e.data.woff2.startsWith("//"),e.data.woff2),r=(e.data.woff.startsWith("//"),e.data.woff),s=(e.data.truetype.startsWith("//"),e.data.truetype);t.innerHTML=`
        @font-face {
            font-family: '${n}';
            src: url('${o}') format('woff2'),
                 url('${r}') format('woff'),
                 url('${s}') format('truetype');
        }
    `,document.head.appendChild(t),F[e.name]=t,console.log("已挂载字体:",e.name)}function Ln(e){const t=F[e.name];t&&t.parentNode&&(t.parentNode.removeChild(t),delete F[e.name],console.log("已卸载字体:",e.name))}const In=["innerHTML"],Mn={name:"lp-icon"},U=a.defineComponent({...Mn,props:{is:{default:"loading"},size:{default:12},color:{default:"#000000"}},emits:["click"],setup(e,{emit:t}){const n=t,o=a.useAttrs(),r={},s=a.ref(""),i=e;a.watch(()=>i.is,async(d,f)=>{if(d!==f){if(r[d]){s.value="&#x"+r[d];return}try{r[d]=await Oe(d),s.value="&#x"+r[d]}catch(u){console.error("加载图标失败",u)}}},{immediate:!0});const l=a.computed(()=>{const{size:d,color:f}=i;let u=d;return $n(d)&&(u=parseInt(d,10)),{fontSize:`${u}px`,color:f,display:"inline-flex",fontFamily:"'default'"}}),m=d=>{n("click",d)};return(d,f)=>(a.openBlock(),a.createElementBlock("i",{class:a.normalizeClass(["lp-icon",[a.unref(o).class]]),style:a.normalizeStyle(l.value),innerHTML:s.value,onClick:m},null,14,In))}}),Nn=(e,t)=>{const n=e.__vccOpts||e;for(const[o,r]of t)n[o]=r;return n},vn=["fill"],Bn=["xlink:href"],D=Nn(Object.assign({name:"LpSvg"},{props:{icon:{type:String,required:!0},size:{type:[Number,String],default:12},color:{type:String,default:"#000000"}},setup(e){const t=e,n=a.computed(()=>`#${t.icon}`),o=a.computed(()=>{const{size:r,color:s}=t;let i=`${r}`;return i=`${i.replace("px","")}px`,{width:i,fill:s,height:i}});return(r,s)=>(a.openBlock(),a.createElementBlock("svg",{class:a.normalizeClass([r.$attrs.class]),style:a.normalizeStyle(o.value),fill:e.color,"aria-hidden":"true"},[a.createElementVNode("use",{"xlink:href":n.value},null,8,Bn)],14,vn))}}),[["__scopeId","data-v-4508aad0"]]),Gn=Object.freeze(Object.defineProperty({__proto__:null,LpIcon:U,LpSvg:D,default:{install:e=>{e.component(U.name,U),e.component(D.name,D)}}},Symbol.toStringTag,{value:"Module"}));function Vn(e){let t={};for(const n in e)t[n]=()=>{var o;return(o=e[n])==null?void 0:o.map(R)};return t}function R(e){if(typeof e=="string"||typeof e=="number")return e;const{component:t,props:n,children:o}=e;let r={};return e.slots&&(r={...r,...Vn(e.slots)}),o&&o.length>0&&(r.default=()=>o==null?void 0:o.map(R)),t.includes("@")?a.createVNode(L,{...n,is:t},r):a.createVNode(t,n||{},o==null?void 0:o.map(R))}function zn(e,t){console.log("useRenderComponent",e);const n=a.reactive({layout:e});return a.defineComponent({name:"DynamicLayout",setup(){return console.log("useRenderComponent setup",n.layout),()=>a.h("div",{},n.layout.map(o=>R(o)))}})}const Fn={class:"lp-layout"},Un={name:"LpLayout"},Y=a.defineComponent({...Un,props:{data:{type:[Object,Array],default:()=>[]}},setup(e){const t=a.useAttrs(),n=a.useSlots();a.reactive({});const r=zn(e.data);return a.onMounted(()=>{console.log(t),console.log("layout slots",n)}),(s,i)=>(a.openBlock(),a.createElementBlock("div",Fn,[(a.openBlock(),a.createBlock(a.resolveDynamicComponent(a.unref(r))))]))}}),Dn=Object.freeze(Object.defineProperty({__proto__:null,LpLayout:Y,default:{install:e=>{e.component(Y.name,Y)}}},Symbol.toStringTag,{value:"Module"}));function Te(e){const t=Object.assign({"./lp-component/index.ts":Qe,"./lp-icon/index.ts":Gn,"./lp-layout/index.ts":Dn});console.debug("%cglobalComponents","color:green",t),Object.keys(t).forEach(n=>{const o=t[n].default;Tn(o)||e.use(o)})}function Rn(e,t){if(!e)throw new Error("Invalid component: "+e);if(typeof e=="string"){if(qn(e))return W(e);if(!t)throw new Error("获取全局组件失败：未提供 Vue 应用实例");const n=t.component(e);if(!n)throw new Error(`Component "${e}" not found in app registry`);return n}if(typeof e=="object"&&!("then"in e))return e;if(e instanceof Promise||typeof e=="object"&&"then"in e)return a.defineAsyncComponent(()=>e.then(n=>n.default||n));if(typeof e=="function"){const n=e();return n instanceof Promise||typeof n=="object"&&"then"in n?a.defineAsyncComponent(()=>n.then(o=>o.default||o)):e}throw new Error("Unknown component type: "+e)}function qn(e){return e.includes("@")}function Pe(e){e=e||{};const t=w.create({baseURL:e.baseURL,timeout:e.timeout||1e4,headers:{...e.headers||{}}});return e.requestInterceptors&&t.interceptors.request.use(e.requestInterceptors,n=>(console.log("request",{err:n}),Promise.reject(n))),e.responseInterceptors&&t.interceptors.response.use(e.responseInterceptors,n=>(console.log("response err",{err:n}),Promise.reject(n))),e.baseInterceptors&&!(e.requestInterceptors||e.responseInterceptors)&&(t.interceptors.request.use(n=>(console.log("request",{config:n}),n)),t.interceptors.response.use(n=>(console.log("response",{response:n}),n.data))),t}class P extends Error{constructor(n,o=0,r={}){super(n);g(this,"code");g(this,"data");g(this,"name","LooplanException");this.code=o,this.data=r,Object.setPrototypeOf(this,P.prototype)}getData(){return this.data}getCode(){return this.code}getMessage(){return this.message}}class Ae{constructor(t,n){g(this,"space");g(this,"modelName");this.space=t,this.modelName=n}handleResult(t){if(t.code!==200)throw new P(t.msg||"请求失败",t.code,t.data)}async list(){const{instance:t}=this.space;let n=await t.post(`${this.modelName}.list`);return{code:n.code,msg:n.msg||"请求成功",data:n.data||{},list:n.data.list||[]}}async paginate(t=1,n=10,o={}){const{instance:r}=this.space;let s=await r.post(`${this.modelName}.paginate`,{page:t,psize:n,...o}),i=s.data.list,l=(i==null?void 0:i.data)||[];return delete i.list,{code:s.code,msg:s.msg||"请求成功",data:s.data||{},list:l,pageStatus:i||{}}}async paginateX(t,n,o={}){const{instance:r}=this.space;let s=await r.post(`${this.modelName}.paginateX`,{lastIndex:t,options:n||null,...o}),i=s.data.list,l=(i==null?void 0:i.data)||[];return delete i.list,{code:s.code,msg:s.msg||"请求成功",data:s.data||{},list:l,pageStatus:i||{}}}async save(t,n){const{instance:o}=this.space;return await o.post(`${this.modelName}.save`,{id:n,data:t})}async add(t){const{instance:n}=this.space;return await n.post(`${this.modelName}.save`,{data:t})}async update(t,n){const{instance:o}=this.space;return await o.post(`${this.modelName}.save`,{id:n,data:t})}async delete(t){const{instance:n}=this.space;return await n.post(`${this.modelName}.delete`,{id:t})}async row(t){const{instance:n}=this.space;return await n.post(`${this.modelName}.row`,{id:t})}async multiSave(t){const{instance:n}=this.space;return await n.post(`${this.modelName}.multiSave`,{list:t})}}class Wn{constructor(t){g(this,"url");g(this,"options");g(this,"instance");this.url=t.url,this.options=t,this.createApiClient()}createApiClient(){this.instance=Pe({baseURL:this.url,timeout:1e4,headers:{},requestInterceptors:t=>{var r,s;console.log(t),t.headers["Content-Type"]||(t.headers["Content-Type"]="application/json");const n=((s=(r=this.options).provideToken)==null?void 0:s.call(r))||"",o=this.options.tokenField||"Authorization";return n&&(t.headers[o]=n),t},responseInterceptors:t=>(console.log(t),t.data)})}useModel(t){return new Ae(this,t)}useCloudFunction(t){return n=>this.callCloudFunction(t,n)}useCloudObject(t){const n=this;return new Proxy({},{get(o,r){if(r!=="then")return(...s)=>{const i=s.length>0?s[0]:{};return n.callCloudObject(t,r,i)}}})}async callCloudObject(t,n,o){const r=`${t}.${n}`;try{return console.log(`调用云对象: ${r}`,o),await this.instance.post(`/${r}`,o)}catch(s){throw new P(s.message||"云对象调用失败",s.code||0,s.data||{})}}async callCloudFunction(t,n){try{return console.log(`调用云函数: ${t}`,n),await this.instance.post(`/${t}`,n)}catch(o){throw new P(o.message||"云函数调用失败",o.code||0,o.data||{})}}}function Ee(e){Te(e)}const xn={install:Ee};c.IconPackages=T,c.JsDataType=Ve,c.LooplanException=P,c.LpComponent=L,c.LpIcon=U,c.LpSvg=D,c.ModelClient=Ae,c.ModelSpace=Wn,c.asyncComponentDelay=He,c.createApi=Pe,c.default=xn,c.gatewayOptions=$,c.getComponentOption=Je,c.getComponentPackage=ee,c.getIconPackage=Se,c.getLoadedStyles=We,c.iconGatewayOptions=O,c.install=Ee,c.isStyleLoaded=qe,c.loadComponent=W,c.loadIcon=Oe,c.loadStyle=De,c.mountIconfont=ke,c.nameIsUseAsyncComponent=ze,c.registerLooplanComponents=Te,c.registerPackage=Ue,c.resolveComponent=Rn,c.setComponentPackage=Fe,c.setGateway=Le,c.setIconGateway=Pn,c.setIconPackage=An,c.unloadAllStyles=xe,c.unloadStyle=Re,c.unmountIconfont=Ln,Object.defineProperties(c,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
